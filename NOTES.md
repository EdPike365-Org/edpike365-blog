To use gatsby-remark-katex, you need to install the version of katex that the plugin uses.
Do not follow the plugin instructions to install them all at once, leave off the "katex" install.
After install the plugin, type "npm list katex" to see which version it wants, because it will likely be lower than the one that you would install by default.

To use gatsby-remark-prismjs, you have to install prismjs. However, not like katex, so it doesnt seem to matter which version you install.

--legacy-peer-deps